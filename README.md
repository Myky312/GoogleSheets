# GoogleSheet

GoogleSheet — это веб-приложение для работы с электронными таблицами, которое повторяет функциональность Google Sheets.  
Оно позволяет пользователям создавать и управлять таблицами, добавлять несколько листов в каждую таблицу и работать с данными и формулами в ячейках.  
Приложение поддерживает работу в режиме реального времени, позволяя нескольким пользователям одновременно редактировать одну и ту же таблицу.

---

## Ключевые особенности

### **Аутентификация и авторизация пользователей**
- **Безопасная регистрация и вход**: Аутентификация на основе JWT обеспечивает безопасный доступ только для авторизованных пользователей.
- **Заголовок авторизации**: Используйте токен в заголовке `Authorization` для маршрутов, требующих аутентификации.

---

### **Управление таблицами (Spreadsheets)**
- **Создание таблиц**: Возможность создавать новые таблицы для организации данных.
- **Обновление и удаление**: Редактирование данных таблицы или удаление таблиц, которые больше не нужны.
- **Управление доступом**: Делитесь таблицами с другими пользователями, добавляя их как соавторов для совместного редактирования.

---

### **Управление листами (Sheets)**
- **Добавление листов**: Создавайте несколько листов в одной таблице для логичной организации данных.
- **Переименование и удаление листов**: Обновляйте названия листов для удобства или удаляйте ненужные листы.

---

### **Управление ячейками (Cells)**
- **Создание и обновление ячеек**: Ввод данных, формул или гиперссылок в ячейки.
- **Получение данных ячеек**: Извлечение содержимого конкретных ячеек.
- **Удаление ячеек**: Очистка содержимого ячеек при необходимости.

---

### **Обработка формул**
- **Базовые арифметические операции**: Поддержка основных математических операций в ячейках.
- **Ссылки на ячейки**: Использование ссылок на другие ячейки для вычислений.
- **Обработка ошибок**: Обнаружение и сообщение об ошибках в формулах, таких как циклические ссылки или синтаксические ошибки.

---

### **Совместная работа в реальном времени**
- **Интеграция Socket.io**: Обеспечивает мгновенную синхронизацию изменений между всеми соавторами.

---

### **Документация API**
- **Swagger UI**: Подробная документация API с описанием всех конечных точек, параметров запросов и форматов ответов.

---

## Технологический стек

### **Backend**
- **Node.js**: Серверное окружение для JavaScript.
- **Express.js**: Веб-фреймворк для создания RESTful API.
- **Sequelize ORM**: Инструмент для взаимодействия с базами данных.
- **Socket.io**: Обеспечивает двустороннюю связь в режиме реального времени между сервером и клиентами.
- **JWT (JSON Web Tokens)**: Для безопасной аутентификации и авторизации.
- **Express-Validator**: Middleware для проверки и очистки пользовательского ввода.

---

### **База данных**
- **Реляционные базы данных**: Поддерживаются PostgreSQL, MySQL или любые другие SQL-базы данных, совместимые с Sequelize.

---

### **Тестирование**
- **Jest**: Фреймворк для модульного и интеграционного тестирования.
- **Supertest**: Для тестирования HTTP-эндпоинтов.

---

### **Документация**
- **Swagger (OpenAPI)**: Для автоматической генерации документации API.

---

## Начало работы

### **Предварительные требования**
- **Node.js и npm**: Установленные на вашем устройстве.
- **Docker и Docker Compose**: Установленные на вашем устройстве.
- **Настроенная и запущенная SQL-база данных** (например, PostgreSQL, MySQL).
- **Установленный Git для контроля версий** (опционально).

---

### **Установка и запуск с использованием Docker**

1. **Клонируйте репозиторий:**

    ```bash
    git clone https://github.com/ваш-репозиторий/google-sheet-backend.git
    cd google-sheet-backend
    ```

2. **Создайте файл `.env` на основе `.env.example` и настройте переменные окружения:**

    ```bash
    cp .env.example .env
    cp .env.test.example .env.test
    ```

3. **Запустите приложение с помощью Docker Compose:**

    ```bash
    docker-compose up --build
    ```

4. **Остановите и удалите контейнеры, сети и тома:**

    ```bash
    docker-compose down --volumes
    ```

---

## Аутентификация

1. **Регистрация**: Создайте новую учетную запись пользователя, используя конечную точку `/auth/register`.
2. **Вход**: Получите JWT-токен, авторизовавшись через конечную точку `/auth/login`.
3. **Заголовок авторизации**: Добавьте токен в заголовок `Authorization` для маршрутов, требующих аутентификации:

    ```plaintext
    Authorization: Bearer your_jwt_token
    ```

---

## API-эндпоинты

### **Аутентификация (Authentication)**
- **Регистрация**: `POST /auth/register`
- **Вход**: `POST /auth/login`
- **Обновление токена**: `POST /auth/refresh-token`

---

### **Таблицы (Spreadsheets)**
- **Создание**: `POST /spreadsheets`
- **Получение всех таблиц**: `GET /spreadsheets`
- **Получение одной таблицы**: `GET /spreadsheets/:spreadsheetId`
- **Обновление**: `PUT /spreadsheets/:spreadsheetId`
- **Удаление**: `DELETE /spreadsheets/:spreadsheetId`
- **Добавление соавтора**: `POST /spreadsheets/:spreadsheetId/add-collaborator`
- **Удаление соавтора**: `DELETE /spreadsheets/:spreadsheetId/remove-collaborator`

---

### **Листы (Sheets)**
- **Создание**: `POST /spreadsheets/:spreadsheetId/sheets`
- **Получение всех листов**: `GET /spreadsheets/:spreadsheetId/sheets`
- **Получение одного листа**: `GET /spreadsheets/:spreadsheetId/sheets/:sheetId`
- **Обновление**: `PUT /spreadsheets/:spreadsheetId/sheets/:sheetId`
- **Удаление**: `DELETE /spreadsheets/:spreadsheetId/sheets/:sheetId`

---

### **Ячейки (Cells)**
- **Создание или обновление**: `POST /spreadsheets/:spreadsheetId/sheets/:sheetId/cells`
- **Массовое создание или обновление**: `PUT /spreadsheets/:spreadsheetId/sheets/:sheetId/cells`
- **Получение всех ячеек**: `GET /spreadsheets/:spreadsheetId/sheets/:sheetId/cells`
- **Получение одной ячейки**: `GET /spreadsheets/:spreadsheetId/sheets/:sheetId/cells/:row/:column`
- **Обновление конкретной ячейки**: `PUT /spreadsheets/:spreadsheetId/sheets/:sheetId/cells/:row/:column`
- **Удаление ячейки**: `DELETE /spreadsheets/:spreadsheetId/sheets/:sheetId/cells/:row/:column`
- **Удаление строки**: `DELETE /spreadsheets/:spreadsheetId/sheets/:sheetId/cells/rows/:row`
- **Удаление столбца**: `DELETE /spreadsheets/:spreadsheetId/sheets/:sheetId/cells/columns/:column`

---

### **Формулы (Formulas)**
- **Оценка формулы**: `POST /formulas/evaluate`

---

## Обработка формул

При обновлении содержимого ячейки формулой (например, `=SUM(A1:A10)`), приложение автоматически вычисляет результат формулы и обновляет значение ячейки соответствующим образом.

---

## Документация API

После запуска приложения, документация API доступна по адресу: [http://localhost:3000/api-docs](http://localhost:3000/api-docs)

---

## Тестирование

Для запуска тестов используйте следующие команды:

```bash
npm install
npm test
